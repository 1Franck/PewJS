<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../favicon.ico">

    <title>PewJS</title>

    <!-- Bootstrap core CSS -->
    <link href="http://maxcdn.bootstrapcdn.com/bootswatch/3.3.1/slate/bootstrap.min.css" rel="stylesheet">
    <link href="assets/monokai_sublime.css" rel="stylesheet">
    <link href="assets/ubuntu.css" rel="stylesheet">
    <style>
      body {
        height: 100%;
        background-color: #373737;
        font-family: UbuntuRegular;
        font-size: 14px;
      }
      pre {
        background-color: rgba(0,0,0,0.1);
        border: 0;
        padding:10px;
      }
      h1,h2,h3,h4,h5,h6 {
        color:#D98D00;
      }
    </style>
  </head>
    
  <body>
    <div class="container">
    <h2 id="pewjs-documentation">PewJS / Documentation</h2>
<p>PewJS is a tiny HTML5 Canvas framework for games and animations.</p>
<p>@see <a href="https://github.com/1Franck/PewJS/">Github project</a></p>
<p><strong>Overview:</strong></p>
<ul>
<li><a href="#quick-start">Quick Start</a></li>
<li><a href="#project">Project</a></li>
<li><a href="#scenes">Scenes</a></li>
<li><a href="#canvas-layers">Canvas layers</a><ul>
<li><a href="#draw">Draw</a></li>
</ul>
</li>
<li><a href="#input">Inputs</a><ul>
<li><a href="#keyboard">Keyboard</a></li>
<li><a href="#mouse">Mouse</a></li>
</ul>
</li>
<li><a href="#resources-imagesaudio">Resources (images/audio)</a></li>
<li><a href="#scope">Scope</a></li>
<li><a href="#utilities">Utilities</a></li>
<li><a href="#extending-pewjs">Extending PewJS</a></li>
<li><a href="#license">License</a></li>
</ul>
<h2 id="quick-start">Quick Start</h2>
<p>Take a look at this boiler plate. <strong>We will use this code as reference for the next paragraphs.</strong></p>
<pre><code class="lang-javascript"><span class="comment">// Create the game</span>
<span class="keyword">var</span> game = Pew.createProject({
    title  : <span class="string">"My Game"</span>,
});

<span class="comment">// Create a scene</span>
game.createScene(<span class="string">'myscene'</span>, (<span class="keyword">function</span>(){

    <span class="comment">// Scene properties</span>
    <span class="keyword">var</span> scene = {};

    <span class="comment">// Create canvas layers </span>
    <span class="keyword">var</span> layerA = game.createLayer(<span class="string">'background'</span>),
        layerB = game.createLayer(<span class="string">'foreground'</span>);

    <span class="comment">// Start inputs capture</span>
    <span class="comment">// Mouse note: to work properly, mouse event must </span>
    <span class="comment">// be associated to the highest z-index canvas which </span>
    <span class="comment">// is always the last one created</span>
    game.keyboard.init();
    game.mouse.init(layerB.canvas); 


    <span class="comment">// Called once when animation start</span>
    scene.init = <span class="keyword">function</span>() {
    };

    <span class="comment">// Update loop</span>
    scene.update = <span class="keyword">function</span>() { 
    };

    <span class="comment">// Draw loop</span>
    scene.draw = <span class="keyword">function</span>() {

        scene.update();

        <span class="comment">//&lt;!-- your stuff --&gt;</span>

        <span class="comment">// request animation frame</span>
        <span class="comment">// by default scene draw() is called again.</span>
        <span class="comment">// Switch to another property callback for </span>
        <span class="comment">// animation frame by specifying it within requestAnim().</span>
        <span class="comment">// ex: scene.requestAnim("mypropertyname");</span>
        scene.requestAnim();
    };

    <span class="comment">// always return scene object</span>
    <span class="keyword">return</span> scene;

})());


<span class="comment">// Start scene animation loop</span>
game.start(<span class="string">'myscene'</span>);</code></pre>
<h2 id="project">Project</h2>
<p>Before you create you very first scene, you must create a new project. Your project will hold configs, scene(s), layer(s), etc...</p>
<pre><code class="lang-javascript"><span class="keyword">var</span> game = Pew.createProject({
    title  : <span class="string">"My Game"</span>,
});</code></pre>
<h2 id="scenes">Scenes</h2>
<p>Scenes are javascript modules that encapsulate your animation logic and drawing loop. For small project, most of the time, one scene is sufficient, but there is no limit how many scenes you can have.</p>
<p><strong>Create a new scene:</strong> (see <a href="#quick-start">Quick Start</a> boiler plate for more details)</p>
<pre><code class="lang-javascript">game.createScene(<span class="string">'scene_name'</span>, (<span class="keyword">function</span>(){ ... })());</code></pre>
<p><strong>Request next animation frame</strong>. By default, scene.draw is used</p>
<pre><code class="lang-javascript">scene.draw = <span class="keyword">function</span>() {
    ...
    <span class="comment">// recall scene.draw()</span>
    scene.requestAnim(); 
}</code></pre>
<p><strong>Change</strong> animation <strong>loop</strong> frame <strong>callback</strong></p>
<pre><code class="lang-javascript">scene.draw = <span class="keyword">function</span>() {
    ...
    <span class="keyword">if</span>(foo === <span class="string">"bar"</span>) {
        <span class="keyword">return</span> scene.draw2();
    }
    scene.requestAnim();
}

scene.draw2 = <span class="keyword">function</span>() {
    ...
    scene.requestAnim(scene.draw2);
}</code></pre>
<p><strong>Pause</strong> the animation loop</p>
<pre><code class="lang-javascript">scene.draw = <span class="keyword">function</span>() {
    ...
    <span class="keyword">if</span>(foo === <span class="string">"bar"</span>) {
        <span class="keyword">return</span> scene.cancelAnim();
    }
    scene.requestAnim();
}</code></pre>
<p><strong>Toggle</strong> the loop (request/cancel)</p>
<pre><code class="lang-javascript"><span class="comment">// example of pause toggle button</span>
game.keyboard.on(<span class="string">"p"</span>, <span class="keyword">function</span>(){
    scene.toggleAnim();
});</code></pre>
<p><strong>Check</strong> the loop status (idle/playing)</p>
<pre><code class="lang-javascript"><span class="keyword">if</span>(scene.is(<span class="string">'idle'</span>)) { ... }
...
<span class="keyword">if</span>(scene.is(<span class="string">'playing'</span>)) { ... }</code></pre>
<h2 id="canvas-layers">Canvas layers</h2>
<p>A layer is a canvas. You can have one or many layers. Each time you create a new layer, it create a DOM canvas element with an z-index higher than previous layer.</p>
<pre><code class="lang-javascript"><span class="comment">// Create canvas layers</span>
<span class="keyword">var</span> layerA = game.createLayer(<span class="string">'background'</span>),
    layerB = game.createLayer(<span class="string">'foreground'</span>);</code></pre>
<p>By default, layer take all browser window space. </p>
<p>Change layer configs:</p>
<pre><code class="lang-javascript"><span class="keyword">var</span> layerA = game.createLayer(<span class="string">'platform'</span>, {
    full: <span class="literal">false</span>,
    autoresize: <span class="literal">false</span>, <span class="comment">//if true, canvas is resized on window resize</span>
    width: <span class="number">500</span>,
    height: <span class="number">300</span>,
});</code></pre>
<p>You can access to layer canvas DOM element with <code>layerA.canvas</code> property.</p>
<h3 id="draw">Draw</h3>
<p>Simple drawing can be achieved by using game layer canvas context(<strong><code>ctx</code></strong>) property which is just a reference to <code>canvas.getContext(&#39;2d&#39;)</code> (<a href="http://www.html5canvastutorials.com/tutorials/html5-canvas-element/">more info</a>).</p>
<pre><code class="lang-javascript">layerA.ctx.fillStyle = <span class="string">"#DD0000"</span>;
layerA.ctx.font = <span class="string">"14px monospace"</span>;
layerA.ctx.fillText(<span class="string">"Welcome to foobar"</span>,<span class="number">10</span>,<span class="number">50</span>);</code></pre>
<h2 id="inputs">Inputs</h2>
<h3 id="keyboard">Keyboard</h3>
<p>Before you binds some keyboard events, you need to enable keyboard event listener.</p>
<pre><code class="lang-javascript">game.keyboard.init();</code></pre>
<p><strong>Capture a key</strong> event and execute fn callback:</p>
<pre><code class="lang-javascript">game.keyboard.on(<span class="string">"p"</span>, <span class="keyword">function</span>() { ... });
<span class="comment">// alternatively, you can use the upperchar keycode (80 = P)</span>
game.keyboard.on(<span class="number">80</span>, <span class="keyword">function</span>() { ... });</code></pre>
<p><strong>Capture a group of keys</strong> events and execute fn callback:</p>
<pre><code class="lang-javascript">game.keyboard.on([<span class="string">"space"</span>, <span class="string">"ctrl"</span>, <span class="string">"alt"</span>], <span class="keyword">function</span>(key) {

    <span class="keyword">if</span>(key.code === <span class="number">32</span>) console.log(<span class="string">'You have pressed SPACEBAR'</span>);
    <span class="comment">// or (note: key.char is always lower case)</span>
    <span class="keyword">if</span>(key.char === <span class="string">"space"</span>) console.log(<span class="string">'You have pressed SPACEBAR'</span>);
    ...
});</code></pre>
<p>Note: Binding key(s) with on() always prevent event default. It is possible to bind special keys like <strong>F1</strong> to <strong>F12</strong>, <strong>Esc</strong>, <strong>Return</strong>, etc.. But remember that it will prevent browser native behavior. Ex: Binding an event for F5 will prevent browser refresh.</p>
<p><strong>Stop capturing</strong> key(s):</p>
<pre><code class="lang-javascript">game.keyboard.off(<span class="number">80</span>); <span class="comment">// 80 = P</span>
game.keyboard.off(<span class="string">"a"</span>); 
game.keyboard.off([<span class="string">"space"</span>, <span class="string">"ctrl"</span>, <span class="string">"alt"</span>]);  
game.keyboard.off();  <span class="comment">// unbind everything</span></code></pre>
<p><strong>Check</strong> a key <strong>manually</strong>:</p>
<pre><code class="lang-javascript"><span class="keyword">if</span>(game.keyboard.key(<span class="string">'space'</span>)) {
    console.log(<span class="string">'spacebar pressed!'</span>);
}
<span class="comment">//get an array of all pressed keys at this very moment</span>
<span class="keyword">var</span> pressed_keys = game.keyboard.keys();</code></pre>
<p><strong>Trigger manually</strong> a key:</p>
<pre><code class="lang-javascript">game.keyboard.trigger(<span class="string">"space"</span>);</code></pre>
<p><strong>Capturing all keys</strong> nonobstructive way. </p>
<p>Important: This is a global callback, and it won&#39;t prevent other callbacks(defined with on()) from being triggered and won&#39;t prevent native browser behavior by default. </p>
<p>To stop propagation, you need to add <code>return false</code> to your onAll() callback. To prevent native behavior, you need to add <code>event.preventDefault()</code> to your onAll() callback.</p>
<pre><code class="lang-javascript">
game.keyboard.on(<span class="string">"p"</span>, <span class="keyword">function</span>() {
    console.log(<span class="string">"pressed 1"</span>);
});
game.keyboard.onAll(<span class="keyword">function</span>(event, key) {
    <span class="keyword">if</span>(key.char === <span class="string">"p"</span>) console.log(<span class="string">"pressed 2"</span>);
});

<span class="comment">// when pressing "p", output will be</span>
<span class="comment">// "pressed 2"</span>
<span class="comment">// "pressed 1"</span>

...

game.keyboard.on(<span class="string">"space"</span>, <span class="keyword">function</span>() {
    console.log(<span class="string">"pressed 1"</span>);
});
game.keyboard.onAll(<span class="keyword">function</span>(event, key) {
    <span class="keyword">if</span>(key.char === <span class="string">"space"</span>) console.log(<span class="string">"pressed 2"</span>);
    <span class="keyword">return</span> <span class="literal">false</span>;
});

<span class="comment">// when pressing "space", output will be</span>
<span class="comment">// "pressed 2"</span>

...

game.keyboard.onAll(<span class="keyword">function</span>(event, key) {
    <span class="keyword">if</span>(key.char === <span class="string">"backspace"</span>) 
        <span class="comment">//...</span>
        event.preventDefault(); <span class="comment">// prevent browser behavior</span>
    }
});</code></pre>
<p><strong>Stop capturing all keys</strong>. It will remove global callback only, but not other callbacks defined with on().</p>
<pre><code class="lang-javascript">game.keyboard.offAll();</code></pre>
<h3 id="mouse">Mouse</h3>
<p>Before you binds mouse events, you need to enable mouse event listener.</p>
<p>If you have more than one layer, mouse events listener must be associated to the highest z-index canvas which is always the last one created by <code>createLayer()</code></p>
<pre><code class="lang-javascript">game.mouse.init(layerB.canvas);</code></pre>
<p><strong>Capture mouse click</strong> event and execute fn callback:</p>
<pre><code class="lang-javascript">game.mouse.on(<span class="string">"click"</span>, <span class="keyword">function</span>() {
    ...
});</code></pre>
<p><strong>Stop capturing</strong> mouse event(s):</p>
<pre><code class="lang-javascript">game.mouse.off(<span class="string">"click"</span>);</code></pre>
<p>Access to current <strong>cursor position</strong>:</p>
<pre><code class="lang-javascript"><span class="keyword">var</span> x = game.mouse.x();
<span class="keyword">var</span> y = game.mouse.y();</code></pre>
<h2 id="resources-images-audio-">Resources (images/audio)</h2>
<p>Support image and audio. Resource url are relative.</p>
<p><strong>Loading resource</strong> like an image and call fn when ready.</p>
<pre><code class="lang-javascript">game.resources.load(<span class="string">'img/foobar.jpg'</span>, <span class="keyword">function</span>(){
    ...
});</code></pre>
<p><strong>Loading a group of resource</strong> and call fn when all resource ready.</p>
<pre><code class="lang-javascript">game.resources.load([<span class="string">'img/sprite1.jpg'</span>,<span class="string">'img/sprite1.jpg'</span>,...], <span class="keyword">function</span>(){
    game.start(<span class="string">"mygame"</span>);
});</code></pre>
<p><strong>Loading a group of resource</strong> with progression callback.  Usefull for stuff like a progress bar.</p>
<pre><code class="lang-javascript">game.resources.load([<span class="string">'img/sprite1.jpg'</span>,<span class="string">'img/sprite1.jpg'</span>,...], <span class="keyword">function</span>(){
    game.start(<span class="string">"mygame"</span>);
}, <span class="keyword">function</span>(p) {
    console.log(p.progress + <span class="string">" %"</span>);
});
<span class="comment">//will output:</span>
<span class="comment">//5 %</span>
<span class="comment">//10 %</span>
<span class="comment">// etc...</span></code></pre>
<p><strong>Retreive</strong> and <strong>use</strong> a loaded <strong>resource</strong>.</p>
<pre><code class="lang-javascript"><span class="keyword">var</span> my_img = game.resources.get(<span class="string">'img/foobar.jpg'</span>); 
layerA.ctx.drawImage(my_img , <span class="number">0</span>, <span class="number">0</span>, <span class="number">300</span>, <span class="number">400</span>);</code></pre>
<h2 id="scope">Scope</h2>
<p>Calling Pew.createProject() store a new instance of <code>Pew.Project</code> inside Pew and return it. The other way to access to your project is going through <code>Pew.project()</code></p>
<p>Create project and stored it into variable <code>game</code>: </p>
<pre><code class="lang-javascript"><span class="keyword">var</span> game = Pew.createProject({
    title  : <span class="string">"My Game"</span>,
});

console.log(game.conf.title); <span class="comment">// output "My Game"</span>
console.log(Pew.project().conf.title); <span class="comment">// output "My Game"</span></code></pre>
<p>In case your are out of scope, you can always access at most stuff of your current project via <code>Pew.project()</code></p>
<pre><code class="lang-javascript"><span class="comment">// access to project config object</span>
Pew.project().conf
<span class="comment">// access to a layer object</span>
Pew.project().layers[<span class="string">"layer_name"</span>]
<span class="comment">// access to a scene module</span>
Pew.project().scenes[<span class="string">"scene_name"</span>]
<span class="comment">// access to keyboard module</span>
Pew.project().keyboard
<span class="comment">// access to mouse module</span>
Pew.project().mouse
<span class="comment">// access to resources module</span>
Pew.project().resources</code></pre>
<h2 id="utilities">Utilities</h2>
<p>Utilities can be accessed with <code>Pew.utils.[fn name]</code></p>
<p>Generate a <strong>random number</strong>
<code>Pew.utils.rand(min, max, interval = 1)</code></p>
<pre><code class="lang-javascript">console.log(Pew.utils.rand(<span class="number">1</span>,<span class="number">10</span>)); 
<span class="comment">// output a number between 1 and 10</span>

console.log(Pew.utils.rand(<span class="number">0</span>,<span class="number">100</span>, <span class="number">25</span>)); 
<span class="comment">// output a number between 0 and 100 at interval of 25</span>
<span class="comment">// so possible value here can be 0,25,50,75 or 100 only</span></code></pre>
<p>Get a <strong>random element from an array</strong> 
<code>Pew.utils.randIndex(array);</code></p>
<pre><code class="lang-javascript">console.log( Pew.utils.randIndex([<span class="string">"aaa"</span>,<span class="string">"bbb"</span>,<span class="string">"ccc"</span>]) ); 
<span class="comment">// output one random element form array</span>
<span class="comment">// in this example, output can be "aaa","bbb" or "ccc"</span></code></pre>
<p><strong>Extend an object</strong> with another object
<code>Pew.utils.extend({}, objA, objB)</code></p>
<pre><code class="lang-javascript"><span class="keyword">var</span> objA = { title: <span class="string">"AAA"</span>, x: <span class="number">0</span>, y: <span class="number">0</span> };
<span class="keyword">var</span> objB = { title: <span class="string">"BBB"</span>, x: <span class="number">20</span> };

<span class="comment">// merge objB into objA</span>
console.log( Pew.utils.extend({}, objA, objB) ); 
<span class="comment">// output {title: "BBB", x: 20, y: 0}</span></code></pre>
<h2 id="extending-pewjs">Extending PewJS</h2>
<p>Create your own reusable plugins by extending thoses objects:
<code>Pew.Project</code>, <code>Pew.Layer</code> and <code>Pew.utils</code></p>
<p><em>Example 1:</em></p>
<pre><code class="lang-javascript">Pew.Layer.prototype.circle = <span class="keyword">function</span>(x, y, rad, fill, stroke, line_w) {

    <span class="keyword">this</span>.ctx.beginPath();
    <span class="keyword">this</span>.ctx.arc(x, y, rad, <span class="number">0</span>, <span class="number">2</span> * Math.PI, <span class="literal">false</span>);
    <span class="keyword">this</span>.ctx.fillStyle = fill;
    <span class="keyword">this</span>.ctx.fill();

    <span class="keyword">if</span>(stroke) {
        <span class="keyword">this</span>.ctx.lineWidth = line_w || <span class="number">1</span>;
        <span class="keyword">this</span>.ctx.strokeStyle = stroke;
        <span class="keyword">this</span>.ctx.stroke();
    }
};

<span class="comment">// ex in your scene draw loop:</span>
<span class="comment">// layerA.circle(100,100,10,"#000");</span></code></pre>
<p><em>Example 2:</em></p>
<pre><code class="lang-javascript">Pew.Layer.prototype.gradient = <span class="keyword">function</span>(x, y, x2, y2, colors, stops) {

    x2 = x2 || <span class="keyword">this</span>.canvas.width;
    y2 = y2 || <span class="keyword">this</span>.canvas.height;

    <span class="keyword">var</span> grd = <span class="keyword">this</span>.ctx.createLinearGradient(x, y, x2, y2);

    <span class="keyword">for</span>(<span class="keyword">var</span> i <span class="keyword">in</span> colors) {
        grd.addColorStop(stop[i]||<span class="number">0</span>, colors[i]);
    }

    <span class="keyword">return</span> grd; 
};

<span class="comment">// layers have now access to this function. ex:</span>
<span class="comment">// layerA.ctx.fillStyle = layerA.gradient(0,0,100,100,["#000","#111"],[0.5,1]);</span></code></pre>
<h2 id="license">License</h2>
<p>PewJS is released under the MIT Licence.
Copyright (c) 2014 Fran√ßois Lajoie
<a href="https://github.com/1Franck/PewJS/"><a href="https://github.com/1Franck/PewJS/">https://github.com/1Franck/PewJS/</a></a></p>
<p>Bundled with AnimationFrame 
MIT Licence - Copyright (c) 2013 Oleg Slobodskoi
<a href="https://github.com/kof/animationFrame">https://github.com/kof/animationFrame</a></p>
<p>&nbsp;
&nbsp;
&nbsp;
&nbsp;
&nbsp;
&nbsp;
&nbsp;
&nbsp;
&nbsp;
&nbsp;
&nbsp;</p>
<p>......................PewPew.........Pew.........PewPew...Pew.............</p>

    </div>
    <!-- JavaScript -->
    <script src="http://code.jquery.com/jquery-2.1.3.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>
